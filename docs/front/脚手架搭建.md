---
title: 脚手架搭建
---

# 代码风格

> 通过 EditorConfig + Prettier + ESLint 来确保开发过程中代码风格统一。

## **Editorconfig**

确保编辑器配置层面的编码风格一致性问题。

然而关于代码风格的部分并未涉及，比如是否「需要在语句末尾添加分号」，「字符串使用单引号还是双引号包裹」，「多行对象的书写规范」等等。

```yaml
# http://editorconfig.org
# 如果 root=true 没有配置, EditorConfig 插件将会在工程之外寻找 .editorconfig 文件
root = true

[*]
# 缩进方式 tab或space
indent_style = space

# 缩进大小。设置为tab时为tab_width
indent_size = 4

# 设置为 lf、cr 或 crlf 以控制如何表示换行符。
end_of_line = lf

# 设置为 latin1、utf-8、utf-8-bom、utf-16be 或 utf-16le 来控制字符集。
charset = utf-8

# 设置为 true 以删除换行符之前的任何空格字符，设置为 false 以确保不会。
trim_trailing_whitespace = true

## 设置为 true 以确保文件在保存时以换行符结束，设置为 false 以确保不以换行符结束。
insert_final_newline = true

[*.less]
indent_size = 2

[*.md]
trim_trailing_whitespace = false

[Makefile]
indent_style = tab
```

## **Prettier**

Prettier 通过语法分析将代码解析为 AST 树，在 AST 树上应用代码风格规范重新生成代码。

Prettier 根据文件路径自动推断解析器（.js 文件使用 babel 解析器、.css 文件使用 css 解析器），对代码进行解析。对不同类型文件的识别和解析受限于 Prettier 的内部支持，因此 Prettier 并非覆盖所有类型的文件

Prettier 是一种严格规范的代码风格工具，主张尽量降低可配置性，严格规定组织代码的方式。

Prettier 处理的范围包含

1. 字符串引号风格
2. 空行处理
3. 多行对象格式
4. 分好处理
5. 打印宽度：控制换行
6. 通过换行控制评论影响范围

### **配置文件**

Prettier 使用 `cosmiconfig` 支持配置文件，`cosmiconfig` 是一种常用的配置文件读取工具，按照下述顺序沿文件树寻找配置文件，找到则停止：

- package.json 中的 prettier 字段
- .prettierrc 文件
- .prettierrc.json 文件
- .prettierrc.js 文件
- .prettierrc.toml 文件

```json
{
    "printWidth": 80,
    // 打印宽度，默认是 80 列

    "tabWidth": 2,
    // 缩进所占列数，默认是 2 列

    "useTabs": false,
    // 缩进风格是否是Tab，默认是 false ，使用空格缩进

    "semi": true,
    // 在语句末尾添加分号，默认是 true

    "singleQuote": false,
    // 使用单引号，默认是 false

    "quoteProps": "as-needed",
    // 对象中的属性使用引号，
    // "as-needed" 只对需要的属性加引号，
    // "consistent" 同一对象中属性引号保持统一，有福同享，有难同当
    // "preserve" 强制使用引号。
    // 默认为 as-needed

    "jsxSingleQuotes": false, // JSX中使用单引号，默认是 false

    "trailingComma": "es5",
    // 多行时是否结尾添加逗号
    // "es5" ES5中允许逗号的容器中添加逗号，比如 objects/arrays
    // "all" 尽可能添加逗号
    // "none" 不允许添加逗
    // 默认值是 "es5"

    "bracketSpacing": true,
    // 是否保留对象内侧两端的空格，比如 { foo: bar } 和 {foo:bar} 的区别

    "jsxBracketSameLine": false,
    // 多行 JSX 的元素是否能和属性同行，默认是 false

    "arrowParens": "always",
    // 箭头函数参数使用圆括号包裹 比如 (x) => x 和 x => x 的区别
    // "always" 总是包裹
    // "avoid" 尽可能避免包裹

    "rangeStart": 0,
    // 只格式化文件中的一部分，范围开始于第几行

    "rangeEnd": Infinity,
    // 只格式化文件中的一部分，范围结束于第几行

    "parser": "none"
    // 指定解析器，Prettier会根据文件路径推断解析器
    // 比如 .js 文件使用 babel 解析，.scss 文件使用 post-scss 解析

    "filepath": "none"
    // 指定用于推断使用那个解析器的文件名

    "requirePragma": false
    // 限制只格式化在文件顶部做了需格式化标识的文件
    // 适用于在大型未格式化项目中，先指定少量文件格式化

    "insertPragma": false

    "proseWrap": "preserve"

    "htmlWhitespaceSensitivity": "css"
    // HTML 文件的空格敏感度
    // "css" 和 css 的 display 属性保持一致
    // "strict" 空格敏感
    // "ignore" 空格不敏感

    "vueIndentScriptAndStyle": false
    // 是否对 Vue 文件中 <script> 和 <style> 标签内的代码应用缩进

    "endOfLine": "lf"
    // 换行符

    "embeddedLanguageFormatting": "auto"
    // 是否格式化嵌入引用代码，比如 markdown 文件中嵌入的代码块
    // "auto" Prettier 自动识别并格式化
    // "off" 关闭自动格式化

}

```

### **IDE 与 Git Hooks 集成**

IDE 中下载 Prettier 插件，并选择其为默认格式化工具。若开发者自身习惯于自己的风格，可以选择保存后自动格式化。

通过 Git Hooks 实现提交代码钱自动格式化。

Git 在特定的生命周期给开发者提供了一些钩子函数，具体看官网 [Git - Git 钩子 (git-scm.com) ](https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90)

我们在此只使用“提交工作流”的钩子，提交工作流包括 4 个钩子：

1. `pre-commit` 在提交信息 **编辑前** 运行，在这个阶段塞入 **代码检查** 流程，检查未通过返回非零值即可停止提交流程；
2. `prepare-commit-msg` 在默认信息被创建之后运行，此时正是 **启动编辑器前** ，可在这个阶段加载 `commitizen` 之类的辅助填写工具；
3. `commit-msg` 在 完成编辑后 运行，可在这个阶段借助 `commitlint` 进行提交信息规范性检查；
4. `post-commit` 在 **提交完成后** 运行，在这个阶段一般做一些通知操作。

# spa static mpa 不同项目场景的考虑

# 项目本地启动和构建打包的配置
